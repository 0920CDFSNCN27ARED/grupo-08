<%
    const exists = locals._exists;
    console.log(product);
    let {
        id,
        status,
        tipo_de_producto,
        tabla_de_talles,
        marca,
        product_name,
        sku_visible,
        product_price,
        product_price_special,
        product_price_special_desde,
        product_price_special_hasta,
        descripcion_corta,
        composicion,
        cuidado,
        color,
        stock_talles,
        categorias,
        imagenes
    } = product;

%> 

<!DOCTYPE html>
<html lang="es" class="catalog_product_view">
    <head>
        <% pageTitle = product_name !== undefined ? product_name : 'Ficha de producto' %> <%-
        include('../partials/head') %>
    </head>

    <body>
        <%- include('../partials/header') %>

        <main>
            <article id="product-<%= id %>" class="product_details">
                <div class="product_images">
                    <div class="swiper-container">
                        <div class="swiper-wrapper">
                            <% for( let i = 0; i < imagenes.length; i++ ) { %>
                                <div class="swiper-slide">
                                    <img src="/images/catalog/products/<%= imagenes[i] %>" alt="" />
                                </div>
                            <% } %>
                        </div>

                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="product_info">
                    <div class="product_head">
                        <h1 class="product_name"><%= product_name %></h1>
                        
                        <div class="product_price <%= product_price_special > 0 ? 'discount' : '' %>">
                            <h3 class="regular_price">$8.000</h3>

                            <% if (product_price_special > 0) { %>
                                <h3 class="special_price">$4.000</h3>
                                <h3 class="percent_off">50% OFF</h3>
                            <% } %>
                        </div>
                    </div>

                    <div class="product_attribute_color">
                        <div class="colors_wrapper">
                            <h4>Color</h4>
                            <div class="colors_options">
                                <div class="color selected">
                                    <span></span>
                                </div>
                            </div>
                        </div>
                        <div class="colors_info">
                            <h4><%= color %> </h4>
                        </div>
                    </div>

                    <div class="product_attribute_sizes">
                        <select name="talles" id="talles" value="">
                            <option value="default">Selecciona tu talle</option>
                            <% for( let i = 0; i < stock_talles.length; i++ ) { %>
                                <option value="<%= stock_talles[i] %>"><%= stock_talles[i] %></option>    
                            <% } %>
                        </select>
                    </div>

                    <div class="product_cart_buttons">
                        <button
                            id="add_to_cart"
                            class="button_main_action"
                            onclick="window.location.href = '/carrito'"
                        >
                            AÃ±adir a la bolsa
                        </button>

                        <!--
                        Agregar la clase added_to_wishlist
                        para ver como queda cuando se agrega a favoritos
                     -->
                        <button
                            id="add_to_wishlist"
                            class="button_main_action"
                            onclick="alert('Agregado a lista de deseo')"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="22"
                                height="19.444"
                                viewBox="0 0 22 19.444"
                            >
                                <path
                                    class="a"
                                    d="M19.232,3.041a5.262,5.262,0,0,0-7.444,0L10.774,4.055,9.76,3.041a5.264,5.264,0,0,0-7.444,7.444L3.33,11.5l7.444,7.444L18.218,11.5l1.014-1.014a5.262,5.262,0,0,0,0-7.444Z"
                                    transform="translate(0.226 -0.499)"
                                />
                            </svg>
                        </button>
                    </div>

                    <div class="product_info_wrapper">
                        <ul class="product_info_actions">
                            <li class="product_info_action">
                                <a class="size_guide" href="#tabla_de_talles">Tabla de talles</a>
                            </li>
                            <li class="product_info_action">
                                <a class="re_stock" href="#avisarme_cuando_llegue_mi_talle"
                                    >Avisarme cuando llegue mi talle</a
                                >
                            </li>
                            <li class="product_info_action">
                                <a class="product_description" href="#descripcion"
                                    >Descripcion del producto</a
                                >
                            </li>
                            <li class="product_info_action">
                                <a class="product_composition" href="#material_y_cuidado"
                                    >Material y cuidados</a
                                >
                            </li>
                            <li class="product_info_action">
                                <a class="product_payments_methods" href="#formas_de_pago"
                                    >Envio y formas de pago</a
                                >
                            </li>
                            <li class="product_info_action">
                                <a class="product_share" href="#compartir">Compartir</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </article>
        </main>

        <!-- productos recomendados -->
        <%- include('../components/sliders/featured_slider/index') %>

        <!-- Footer -->
        <%- include('../partials/footer') %>

        <script src="https://unpkg.com/swiper/swiper-bundle.js"></script>
        <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

        <script>

            const producto = document.querySelector('#product-<%= id %>');
            console.log(producto);
            let swiper_photos = new Swiper(producto.querySelector('.swiper-container'), {
                loop: true,
                pagination: {
                    el: '.swiper-pagination',
                },
                breakpoints: {
                    1000: {
                        loop: false,
                        slidesPerView: 2,
                        slidesPerGroup: 2,
                        slidesPerColumn: 10,
                        slidesPerColumnFill: 'row',
                    },
                },
            });

        </script>
    </body>
</html>
